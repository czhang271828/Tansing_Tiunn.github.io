# 偏微分方程笔记(四)

> 本章笔记主要讲述双变量($x$, $t$)线性偏微分方程组的特征理论. 

### 往期回顾

上一期笔记中, 我们方求解程组
$$
\left\{\begin{align*}
u_t+a(t,x)u_x&=f(t,x),\quad x\in\mathbb R, t>0\\
u(0,x)&=\varphi(x)
\end{align*}\right..
$$
得$u=u_1+u_2$, 其中
$$
\left\{\begin{align*}
u_1(t,x):=&\varphi(X(0;t,x))\\
u_2(t,x):=&\int_0^t f(s,X(s;t,x))\mathrm ds\\
\end{align*}\right..
$$
特征线$X(0;t,x)$满足$\dfrac{\mathrm dX(0;t,x)}{\mathrm d t}=a(t,x)$. 

##### 例1

例如, 对于方程组
$$
\begin{align*}
\partial _tu+(x+t)\partial _xu&=t,\quad x\in\mathbb R,t>0\\
u(0,x)&=\varphi(x)
\end{align*}.
$$
先考虑形式$(1,X'(0;t,x))\cdot\nabla u=\partial _tu+(x+t)\partial _xu$. 对经$(t_0,x_0)$处的特征曲线, 有
$$
\begin{align*}
&\dfrac{\partial X(0;t,x_0)}{\partial t}=x+t.\\
&X(t_0)=x_0
\end{align*}
$$
解得$X(0;t,x_0)=-t-1+Ce^{t}$, 其中$C$为常数. 代入初值$X(t_0)=x_0$得
$$
X(0;t,x_0)=(x_0+t_0+1)e^{t-t_0}-t-1.
$$
再考虑
$$
\begin{align*}
&[u(t,X(0;t,x_0))]'=t\\
&u(0,X(0;0,x_0))=\varphi(e^{-t_0}(x_0+t_0+1)-1)
\end{align*}.
$$
解得$u(t,X(0;t,x_0))=\dfrac{t^2}{2}+\varphi(e^{-t_0}(x_0+t_0+1)-1)$. 替换$x_0$作$x$, 则
$$
u(t,x)=\dfrac{t^2}{2}+\varphi(e^{-t}(x+t+1)-1).
$$

##### 例2

对选定的$x_0$, 约定$X(0;t,x_0)$为$X(t)$, $u(t,X(0;t,x_0))$为$U(t)$. 下考虑方程
$$
\begin{align*}
&\partial _tu+3\partial_x u=-u^2,\quad x\in\mathbb R,t>0\\
&u(x,0)=\varphi(x).
\end{align*}
$$
考虑ODE方程$X'(t)=3$, $X(t_0)=x_0$, 得$X(t)=x_0+3(t-t_0)$. 再考虑
$$
\begin{align*}
&U(0)=\varphi(x_0-3t_0)\\
&U'(t)=-U(t)^2
\end{align*}
$$
解得$U(t)=\dfrac{1}{t+1/\varphi(x_0-3t_0)}$. 从而$u(t,x)=\dfrac{\varphi(x-3t)}{1+t\varphi(x-3t)}$. 

### 边值问题

考虑初值问题
$$
\left\{\begin{align*}
u_t+au_x&=f(t,x),\quad x>0, t>0\\
u(0,x)&=\varphi(x)
\end{align*}\right..
$$
当$a\leq 0$时, 每条$\mathbb R_+^2$上的特征线与$\mathbb R_+$均有交点(往左上或上方倾斜). 若$a>0$,  则部分特征线或与$\mathbb R_+$无交点: 以下将细论该情形. 

若$(t_0,x_0)$满足$x_0-at_0>0$, 则特征线过$x$正半轴, 记$\Omega_2:=\{(t,x):x>at\}\cap\mathbb R_+^2$. 若$x_0-at_0<0$, 则特征线过$t$正半轴上点$\left(0,t-\dfrac{x-x_0}{a}\right)$, 记$\Omega_1:=\{(t,x):x<at\}\cap \mathbb R_+^2$. 写至此处可知, 另需初值条件
$$
u(t,0)=\mu(t).
$$
为保证解的连续性, 往往限定
$$
\lim_{t\to 0^+}\mu(t)=\lim_{x\to 0^+}\varphi(x).
$$
实际上, 即便$\mu$与$\varphi$在$\mathbb R_+$上均光滑, $u$于$\partial\Omega_1\cap\partial \Omega_2$上的可微阶数仍无法确定. 

就解方程而言以下过程足矣:

1. 若$(t,x)\in\Omega_2$​, 据先前结论有
   $$
   u(t,x)=\varphi(X(0;t,x))+\int_0^tf(s,X(s,t,x))\mathrm ds.
   $$

2. 若$(t,x)\in\Omega_1$, 则存在唯一的$s(t,x)\in(0,t)$使得$X(s(t,x);t,x)=0$. 从而
   $$
   u(t,x)=\mu(s(t,x))+\int_{s(t,x)}^t f(s;X(s,t,x))\mathrm ds.
   $$

3. 若$(t,x)\in\partial \Omega_1\cap\partial \Omega_2$, 则
   $$
   u(t,x)=\lim_{t\to 0^+}\mu(t)=\lim_{x\to 0^+}\varphi(x).
   $$

##### 相容性条件

若$u$为$C^0$连续, 仅需规定光滑函数$\varphi$, $\mu$, $a(t,x)$, $f(t,x)$满足$\varphi(0)=\mu(0)$; 下探究$C^1$情形. 

注意到若$\partial_tu(t,0)=\mu'(t)$, $\partial_x(0,x)=\varphi'(x)$, 以及$\partial_tu(0,x)=f(0,x)-a(0,x)\varphi'(x)$. 从而
$$
\mu'(0)=f(0,0)-a(0,0)\varphi'(0).
$$
 为$u\in C^1(\{t>0,x>0\})$之必要条件. 下将证明:

##### $C^1$连续定理

若$\varphi$, $\mu$, $a$, $f$均光滑, 则$u$在定义域中$C^1$连续的充要条件为
$$
\left\{\begin{align*}
\mu(0)&=\varphi(0)\\
\mu'(0)&=f(0,0)-a(0,0)\varphi'(0)
\end{align*}\right..
$$
必要性已证, 下证明其充分性. 依通过$(0,0)$之特征线$\Gamma$同上划分$\Omega_1$与$\Omega_2$. 对任意$(t_0,x_0)\in\Gamma$, 显然$u$在$(t_0,x_0)$处连续, 下证明$u$于$(t_0,x_0)$处可微, 即存在常数$A$, $B$使得
$$
u(t_0+\Delta t,x_0+\Delta x)=A\Delta t+B\Delta x+o(\Delta t;\Delta x).
$$
对$(x,t):=(t_0+\Delta t,x_0+\Delta x)\in \Omega_1$, 存在唯一的$s(t,x)\in(0,t)$使得$X(s(t,x);t,x)=0$. 从而
$$
\begin{align*}
\partial_t u(x,t)&=\partial_t\left[\mu(s(t,x))+\int_{s(t,x)}^t f(s;X(s,t,x))\mathrm ds.\right]\\
&=\mu'(0)s'(t,x_0)|_{t=t_0}+\partial_t\int_{s(t,x)}^t f(s;X(s,t,x))\mathrm ds+o(\Delta t;\Delta x)\\
\end{align*}.
$$
对$(x',t'):=(t_0+\Delta t',x_0+\Delta x')\in \Omega_2$都有
$$
\partial_t u(x',t')=\partial_t u(0,x)|_{x=0}+\partial _t\int_0^{t_0}f(s,X(s,t',x'))\mathrm ds+o(\Delta t;\Delta x)
$$
注意到当$t$充分靠近$t_0$时, $s(t,x_0)\sim t$. 故$\partial_t u(t_0,x_0)$于$\Gamma$上相容等价于
$$
\partial_t u(0,x)|_{x=0}=\mu'(0).
$$
即$\mu'(0)=f(0,0)-a(0,0)\varphi'(0)$. 

同理$\partial_x u(x_0,y_0)$兼容若且仅若
$$
\partial _x u(t,0)|_{t=0}=\varphi'(0).
$$
代入$\partial_t u+a\partial_xu=f$知$\mu'(0)=f(0,0)-a(0,0)\varphi'(0)$. 


### 两个自变量的线性微分方程组问题

设$U=(u_1,u_2,\ldots,u_N)^T$, $u_i=u_i(t,x)$. 考虑方程
$$
\left\{\begin{align*}
&\partial_t U+A\partial _xU=F,\quad t>0,x>0\\
&U(0,x)=U_0(x)
\end{align*}\right..
$$
其中$F=(f_1,f_2,\ldots,f_N)^T$, $A_{N\times N}$为系数矩阵. 若有对角化关系$A=P^T \Lambda P$, 则记$V:=PU$即可化原方程为$N$个一阶线性微分方程; 反之, 若$A\sim J$, 则对每个Jordan块从下至上递推即可. 

现不妨设$A$的谱为
$$
-\infty<\lambda_1\leq\cdots\leq\lambda_k\leq 0<\lambda_{k+1}\leq\cdots\lambda_N<\infty.
$$
据先前推导, 若特征线斜率为正数, 则其初值需若干$\mu(t)$确定. 故应限定$B_{(N-k)\times N}$使得$U$满足初值$(BU)(t,0)=\Mu(t)$. 

记右特征向量$r_i$满足$(\lambda_iI-A)r_i=0$, 左特征向量$l_i$满足$l_i(\lambda_iI-A)=0$. 故$l_ir_j=\delta_{ij}$, 且有互逆矩阵
$$
LR:=\begin{pmatrix}l_1\\\vdots\\ l_N\end{pmatrix}\cdot(r_1\cdots r_N)=I_N
$$
满足分解$LAR=\Lambda$. 为使得所有正特征值对应$u_i$于的$t$轴上存在初值, 故有$\mathrm{rank}(B)=N-k$. 进一步地, 设$V=LU$, 则PDE问题转化为
$$
\left\{\begin{align*}
&\partial_t V+\Lambda\partial _xV=LF,\quad t>0,x>0\\
&V(0,x)=LU_0(x)\\
&(BR)V=\Mu(t)
\end{align*}\right..
$$
设$V=\begin{pmatrix}V_{I}\\V_{II}\end{pmatrix}$, 其中$V_I=(v_1,\ldots, v_k)$, $V_{II}=(v_{k+1},\ldots, v_N)$. 再令
$$
R=((r_1\cdots r_k)\,(r_{k+1}\cdots r_{N}))=:(R_1\,R_2).
$$
从而边值条件$(BR)V=\Mu(t)$化为
$$
BR_1V_I+BR_2V_{II}=\Mu(t).
$$
此处$V_I$可通过特征线直接求解, $V_{II}$有解等价于$BR_2$满秩. 