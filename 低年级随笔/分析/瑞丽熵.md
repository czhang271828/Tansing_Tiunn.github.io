## 记号

记$\mathcal P$为可测空间$(\Omega,\mathscr F)$上的测度(或为有符号测度、复测度等), 故$\mathcal P\in\prod_{n\geq 1}\mathbb F^{(n)}$可视作所有至多可数的有序数组, 即
$$
\begin{align*}
&\mathcal P=(p_1,p_2,\cdots,p_n,\cdots)&\text{数组无限,}\\
&\mathcal P=(p_1,\cdots,p_n,0,0\cdots)&\text{数组有限.}\\
\end{align*}
$$
定义$\cup:(\mathcal P_1,\cdots,\mathcal P_n,\cdots)\mapsto(\mathcal P_1,\cdots,\mathcal P_n,\cdots)$为数组之保序无交并. 

***

## Rényi 公设：

1. 实值性：$H(\mathcal P)$ 为非常值的实函数. 

2. 对称性：$H(\mathcal P)$ 关于$\mathcal P$中索引$p_i$对称. 

3. 连续性：$H(\mathcal P)$ 关于$\mathcal P$中变元连续(强调：不是关于$\mathcal P$连续). 

   > $H\not\in C(\{\mathcal P\})$. 例：不妨设$\mathcal P$是至多可列的, 定义度量
   > $$
   > d(\mathcal P_1,\mathcal P_2)=\sum_{i=1}^{\infty}\dfrac{|p^{(1)}_i-p^{(2)}_i|}{2^i}
   > $$
   > 即有反例. 

4. 归一性：$H((1/2))=1$. 

5. 可加性：$H(\mathcal P_1\ast\mathcal P_2)=H(\mathcal P_1)+H(\mathcal P_2)$. 

   > 由于对称性在公设内提及, 故需考虑数组之顺序, 不妨记$\mathcal P_1\ast\mathcal P_2$为矩阵$(p_i^{(1)}p_j^{(2)})$所对应之数组. 若不考虑序关系, 则
   > $$
   > \mathcal P_1\ast\mathcal P_2:=\cup_{p^{(1)}_i\in\mathcal P_1,p^{(2)}_j\in\mathcal P_2}\{p_i^{(1)}p_j^{(2)}\}
   > $$

6. 中值性：存在单调连续函数$g:\mathbb R\to\mathbb R$, 使得
   $$
   H(\mathcal P_1\cup\mathcal P_2)=g^{-1}\left[\dfrac{w(\mathcal P_1)g(H(\mathcal P_1))+w(\mathcal P_2)g(H(\mathcal P_2))}{w(\mathcal P_1\cup\mathcal P_2)}\right]
   $$
   其中$w(\mathcal P)=|\sum_{p_i\in \mathcal P}p_i|$为权. 

7. 光滑性：$H((q,1-q))$于$q=0$光滑. 

***

## 信息熵推导

Lemma 于公设5下, 对任意$q\neq 0$均有$H((q))=-c_{q}\log|q|$, 其中常数$c_q\in\mathbb R$满足对任意$q_1/q_2\in\mathbb Q$均有$c_{q_1}=c_{q_2}$. 其中, $H$之可表述性取决于选择公理. 

证明：置$f(q):=H((q))$, 则对任意$n\in\mathbb Z^*$有$f(nq)=nf(q)$, 进而对任意$r\in\mathbb Q^*$均有$f(rq)=rf(q)$. 得证. 

Lemma 加之公设3下, 对任意$q\neq 0$均有$H((q))=c\log|q|$, 其中常数$c\in\mathbb R$. 

证明：沿用函数$f$. 据实数之完备性, 取收敛于$x\in\mathbb R^*$的非零有理数列$\{r_i\}$即有$f(r_n)\to f(x)$. 得证. 

Lemma 加之公设1, 即有$H((q))=- c\log|q|$, 其中$c\in\mathbb R^*$. 

证明：显然. 

Lemma 加之公设4, 对任意$q\neq 0$均有$H((q))=-\log_2|q|$. 

证明：显然. 

Lemma 加之公设6, 则$g$为线性函数或指数函数. 

证明：由公设6知
$$
\begin{align*}
H(\mathcal P)=&H((p_1)\cup\cdots\cup(p_n)\cup\cdots)\\
=&g^{-1}\left[\dfrac{\sum_i w((p_i))g(H((p_i)))}
{w((p_1)\cup\cdots\cup(p_n)\cup\cdots)}\right]\\
=&g^{-1}\left[\dfrac{\sum_i |p_i|g(-\log_2|p_i|)}
{\sum_i|p_i|}\right]\\
\end{align*}
$$
置$f:\mathbb R_{+}\to\mathbb R,t\mapsto g(-\log_2t)$, 易知$g$单调连续. 由公设5，考虑$H(\mathcal P\ast(q))$则有
$$
f^{-1}\left[\dfrac{\sum_i|p_i|f(|p_iq|)}{|\sum_ip_i|}\right]=|q|f^{-1}\left[\dfrac{\sum_i|p_i|f(|p_i|)}{|\sum_ip_i|}\right]
$$
置$h_q(t)=f(|q|t)$, 则
$$
h_q^{-1}\left[\dfrac{\sum_i|p_i|h_q(|p_i|)}{|\sum_ip_i|}\right]=f^{-1}\left[\dfrac{\sum_i|p_i|f(|p_i|)}{|\sum_ip_i|}\right]
$$
可见$h_q$与$f$等价平均, 下证明$f$与$h_q$为线性关系, 即$h_q=a_qf+b_q$. 

首先, 对任意$\mathcal P$, $h_q=a_qf+b_q$即说明$h_q$与$f$等价平均, 下证明$h_q$一定为$a_qf+b_q$形式. 

Lemma 设$\sum c_n=1,c_n>0$, $\phi(x)$为严格单调且连续的函数, 记加权平均$\mathfrak R_\phi(a):=\phi^{-1}[\sum_n c_n\phi(a)]$, 则$\mathfrak R_\chi(a)\equiv\mathfrak R_\psi(a)$的充要条件为存在常数$\alpha$与$\beta$使得$\chi=\alpha\psi+\beta$.

证明：考虑对任意$t\in[H,K]$
$$
x:=\psi^{-1}\left[\dfrac{K-t}{K-H}\psi(H)+\dfrac{t-H}{K-H}\psi(K)\right]\\=\chi^{-1}\left[\dfrac{K-t}{K-H}\chi(H)+\dfrac{t-H}{K-H}\chi(K)\right]
$$
则当$t$遍历$(H,K)$时, $x$取遍$(H,K)$中所有值, 因此
$$
\begin{align*}
\chi(x)&=\dfrac{K-t}{K-H}\chi(H)+\dfrac{t-H}{K-H}\chi(K)\\
&=\dfrac{\psi(K)-\psi(x)}{\psi(K)-\psi(H)}\chi(H)+\dfrac{\psi(x)-\psi(H)}{\psi(K)-\psi(H)}\chi(K)\\
&=\alpha\psi(x)+\beta
\end{align*}
$$
必要性得证. 充分性显然, 故引理得证. 

因此得函数方程：$f(|q|t)=s(|q|)f(t)+r(|q|)$, 其中$s(|q|)$与$r(|q|)$与$|q|$关联之常数, 且$s(|q|)>0$. 同时即得$f(|q|)=r(|q|)$. 以$y$代$|q|$, 得
$$
\begin{align*}
f(ty)&=s(y)f(t)+f(y)\\
f(ty)&=s(t)f(y)+f(t)
\end{align*}
$$
故$\dfrac{s(t)-1}{f(t)}=\dfrac{s(y)-1}{f(y)}$. 因此存在常数$c$使得$s(t)=1+cf(t)$, 回代得
$$
f(ty)=cf(t)f(y)+f(t)+f(y)
$$

1. 当$c=0$时, 解即为$f=C\log t$. 
2. 当$c\neq 0$时, 原方程化为$[cf(ty)+1]=[cf(t)+1][cf(y)+1]$, 解为$f=\dfrac{x^\alpha-1}{c}$, 这里$\alpha$为任意常数. 

故$g(x)=-ax+b$或$a\cdot 2^{(1-\alpha)x}+b$. 

Lemma 加之剩余公理, 则$g(x)=a\cdot 2^{(1-2k)x}$, 其中$k\in\mathbb N^+$. 

由公理6知$H((q,1-q))=H((q)\cup (1-q))$, 故：

当$g(x)=-ax+b$时有
$$
-a H((q,1-q))+b=a[q\log_2q+(1-q)\log_2(1-q)]+b
$$
即$H((q,1-q))=-q\log q-(1-q)\log(1-q)$, 显然$H\in C^\infty(Q)$. 此时
$$
H(\mathcal P)=-\dfrac{\sum_i|p_i|\log_2|p_i|}{|\sum_i p_i|}
$$
当$g(x)=a\cdot 2^{(1-\alpha)x}+b$有
$$
a\cdot 2^{(1-\alpha)H(\mathcal P)}+b=\dfrac{a\sum_i|p_i|^\alpha+b\sum_i|p_i|}{|\sum_i p_i|}
$$
取$\mathcal P=(q,1-q)$, 由于$\dfrac{|q|+|1-q|}{|q+1-q|}$于$q=0$处不可微, 故$b=0$. 因此
$$
H((q,1-q))=\dfrac{\log_2[|q|^\alpha+|1-q|^\alpha]}{1-\alpha}
$$
显然$\alpha>0$时则$H((0,1))$无界, 舍, 同时公设1要求$\alpha\neq0$, 故$\alpha<0$. 若$\alpha$非整数, 则考虑$q\in\mathbb R_+$, 有
$$
\dfrac{\mathrm d H((q,1-q))}{\mathrm dq}=\dfrac{\alpha}{(\alpha-1)\ln 2}\cdot\dfrac{q^{\alpha-1}+(1-q)^{\alpha-1}}{q^\alpha+(1-q)^\alpha}
$$
故容易推得
$$
\dfrac{\mathrm d^n H((q,1-q))}{\mathrm dq^n}=C_n\cdot\dfrac{p_1^{(n)}(q)+p_2^{(n)}(q)[q^{\alpha-n}+(1-q)^{\alpha-n}]}{p_2^{(n)}(q)}
$$
其中$p_k^{(n)}(q)$为由$q^{\alpha-m}+(1-q)^{\alpha-m},\quad \mathbb Z\ni m<n$组成的多项式. 因此取$n$为某一大于$\alpha$之常数, 则有$\dfrac{\mathrm d^n H((q,1-q))}{\mathrm dq^n}=\infty$, 矛盾. 因此$\alpha$为整数. 

同时,  $\alpha$需为偶数, 反之$\dfrac{\mathrm d^n H((q,1-q))}{\mathrm dq^n}$于$q=0^-$及$q=0^+$时不等. 

因此
$$
H(\mathcal P)=H_{2k}(\mathcal P)=-\dfrac{1}{2k-1}\log_2\left[\dfrac{\sum_i|p_i|^{2k}}{|\sum_i p_i|}\right]
$$
其中$k\in\mathbb N^+$. 

***

## 结论

$$
H(\mathcal P)=H_{2k}(\mathcal P)=-\dfrac{1}{2k-1}\log_2\left[\dfrac{\sum_i|p_i|^{2k}}{|\sum_i p_i|}\right]
$$

或
$$
H(\mathcal P)=-\dfrac{\sum_i|p_i|\log_2|p_i|}{|\sum_i p_i|}
$$
均为符合Rényi 公设之信息熵. 



