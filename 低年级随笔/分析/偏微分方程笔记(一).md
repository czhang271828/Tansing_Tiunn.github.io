#  偏微分方程笔记(一)

> 时间: 14-Sept, 16-Sept. 
>
> 符号说明: 偏导数简写为$\partial _x Y:=\dfrac{\partial Y}{\partial x}$.

### 输运方程

设空间$\mathbb R^n$中的某一区域$\Omega$中存在密度函数$u(t,x)$, 其中$t\in[0,\infty)$为时间, $x\in\Omega\subset \mathbb R^n$为一区域. 由于介质具有流动性, 再设存在流场$\vec F(t,x)$; 介质或可产生与湮没, 再设源函数(密度函数)$f(x,t)$. 以下假设$u(t,x)$关于$t$可微.

对任意$t_1,t_2$满足$0\leq t_1< t_2<\infty$, 任意$D\subset \Omega\subset\mathbb R^n$, 则$D$内介质改变量为
$$
Q_1:=\int_Du(t_2,x)-u(t_1,x)\mathrm d x=\int_{t_1}^{t_2}\int_Du(t_2,x)-u(t_1,x)\mathrm d x\mathrm dt.
$$
对$s\in \partial D$, 记$\vec n(s)$为垂直向外的法向量, 则从$D$边界流出/流入的介质量为
$$
Q_2:=\int_{t_1}^{t_2}\int_{\partial D}\vec F\cdot (-\vec n)\mathrm d s=-\int_{t_1}^{t_2}\int_D\mathrm{div}(\vec F)\mathrm d x\mathrm dt.
$$
其中使用了Gauss定理. 

对$D$内部产生的介质量计算得
$$
Q_3:=\int_{t_1}^{t_2}\int_D f(t,x)\mathrm dx\mathrm dt.
$$
由关系式$Q_1=Q_2+Q_3$知
$$
\int_{t_1}^{t_2}\int_D \dfrac{\partial u}{\partial t}+\mathrm {div} F-f(t,x)\mathrm dx\mathrm dt=0.
$$
从而$\dfrac{\partial u}{\partial t}+\mathrm {div} F=f(t,x)$.

若$f\equiv 0$, $\Omega=\mathbb R^n$, 且$\lim_{|x|\to\infty}\|\vec F\|=0$之情形, 显然有守恒关系
$$
\partial _t\int_{\mathbb R^n}u\mathrm dx=0.
$$
或$\Omega\subset \mathbb R^n$且$(\vec F\cdot\vec n)|_{\partial \Omega}\equiv0$之情形(等价于边界无流入流出), 同样有
$$
\partial _t\int_{\mathbb \Omega}u\mathrm dx=0
$$
成立. 若$f(t,x)\not\equiv0$, 则称之平衡关系. 

### 空气动力学方程

空气动力学方程较输运方程而言, 需增加压强项$p(t,x)$(空气可压缩); 可庆的是, 源函数$f(t,x)$应予删去. 记$\rho(t,x)$为密度函数, $\vec u(t,x)$为流函数(量纲与$x/t$同). 在区域$D\subset \Omega\subset \mathbb R^n$中使用质量守恒定理得
$$
\int_D\int_{t_1}^{t_2}\dfrac{\partial \rho}{\partial t}\mathrm dt\mathrm dx=\int_{\partial D}\int_{t_1}^{t_2}\rho \vec u(t,x)(-\vec n)\mathrm dt\mathrm dx
$$
使用Gauss定理并取微分, 则
$$
\rho_t+\mathrm {div}(\rho \vec u)=0.
$$
另一项守恒为动量守恒(为方便起见, 设空气温度不变, 即不考虑能量方程). 在$j$方向使用冲量定理(冲量转化作始末动量差)得
$$
\int_D(\rho u_j)(t_2,x)-(\rho u_j)(t_1,x)\mathrm d x=\int_{t_1}^{t_2}\int_{\partial D}(\rho_j u_j)\vec u\cdot(-\vec n)\mathrm ds\mathrm dt+\int_{t_1}^{t_2}\int_{\partial D}p\cdot(-n_j)\mathrm ds\mathrm dt
$$
从而
$$
\int_{t_1}^{t_2}\int_{D}\left[\partial_t(\rho u_j)+\sum_{k=1}^n\partial_{x_k}(\rho u_ju_k)+\partial_{x_i}p\right]\mathrm dx\mathrm dt=0.
$$
微分且叠加各分量得$\partial_t(\rho \vec u)+\mathrm{div}(\rho\vec u\otimes\vec u)+\nabla p=0$. 结合质量守恒方程$\rho_t+\mathrm {div}(\rho \vec u)=0$即得所求. 

特殊地, 若$\rho$为定值, 则$\partial_tu=-(u\cdot\nabla)u-\dfrac{1}{\rho}\nabla p$. 添加阻力项得
$$
\partial_tu=-(u\cdot\nabla)u-\dfrac{1}{\rho}\nabla p+\gamma\nabla^2 u+f.
$$
即Navier-Stokes方程. 

### 热方程与行波方程

设$u(t,x)$为温度函数, $c$为比热容, $\rho$为密度. 对任意$D\subset \Omega$, $t_1 ,t_2\in I$, 及$t_2>t_1$, 区域$D$中热量改变量为
$$
Q_1=\int_D\rho c[u(t_2,x)-u(t_1,x)]\mathrm dx=\int_{t_1}^{t_2}\int_D\rho c\partial_t u\mathrm dx
$$
对边界元面$\mathrm d s$, 极小时间内改变的热量与截面面积, 温度差, 时间有关. 从而存在系数$k$使得$\mathrm d Q_2=-k\dfrac{\partial u}{\partial n}\mathrm ds\mathrm dt$, 积分得
$$
\begin{align*}
Q_2&=\int_{t_1}^{t_2}\int_{\partial D}-k\dfrac{\part u}{\part n}\mathrm ds\mathrm dt\\
&=\int_{t_1}^{t_2}\int_{\partial D}-k\nabla u\cdot n\mathrm ds\mathrm dt\\
&=-\int_{t_1}^{t_2}\int_D\mathrm{div}(k\nabla u)\mathrm dx\mathrm dt
\end{align*}
$$
积分源函数$f(t,x)$得$D$自生成的能量, 记
$$
Q_3:=\int_{t_1}^{t_2}\int_D f\mathrm dx\mathrm dt
$$
加和得热方程
$$
\partial_t(\rho cu)-\mathrm {div}(k\nabla u)=f.
$$
特别地, 当$\rho,c,k$为常数时, 记$a=\sqrt{\dfrac{k}{\rho c}}$. 热方程可随即简化作
$$
\partial_tu-a^2\Delta u=\dfrac{f}{\rho c}.
$$
上述式子更像是一种限定, 无以直接求出某一类特需的解. 究其根本, 是边界条件的缺失. 首先有初值条件$u(0,x)=u_0(x)$, 边界条件分以下三类:

1. $\forall t\in I$, $x\in\partial \Omega$, 边界函数$u(t,x)=\varphi(t,x)$已知. 此时称之Dirichlet条件.

2. $\forall t\in I$, $x\in\partial \Omega$, 边界梯度函数$\partial_n u\mid_{I\times \Omega}=\varphi(t,x)$已知(如绝热时$\varphi\equiv 0$). 此时称之Neumann条件. 

3. 设$u_1$为外界温度函数, 则由Newton之热传导定理得径向元面$\mathrm dS$在$\mathrm dt$时间段内改变的热量为
   $$
   \mathrm dQ=k_1(u-u_1)\mathrm dS\mathrm dt.
   $$
   此时
   $$
   -k\partial _n u\mathrm dt\mathrm dS=k_1(u-u_1)\mathrm dt\mathrm dS.
   $$
   即$(\partial_nu+\sigma u)\mid_{T\times \Omega}=\varphi(t,x)$. 称之Robin条件. 

### 一维波动方程

一维波动方程又称弦振动方程, 是一类研究横波性态之方程. 如下图所示, 设$u(t,x)$为偏离平衡位置之程度. 

![](https://files.mdnice.com/user/12571/588556c9-989b-4061-88ba-a19589faf652.png)

为观察模型的主要矛盾, 现给出基本假设:

1. 弦粗细可忽略.
2. 弦上任何一点仅作上下方向的轻微扰动.
3. 弦服从Hooke定律. 

任取弦上点$x$, $x$处与$x+\delta x$处满足以下关系:

1. $x$​方向受力平衡, 即对任意$t$均有
   $$
   T(t,x+\delta x)\cos\alpha=T(t,x)\cos\beta.
   $$
   注意到
   $$
   |\partial_x T|\leq n|T(t,x)|\cdot\dfrac{|1-\frac{\cos\beta}{\cos\alpha}|}{|\delta x|}=C\cdot\dfrac{\delta\theta}{\delta x}.
   $$
   此处限定为其为轻微扰动, 因此曲率远小于$1$, 即
   $$
   \lim_{\delta x}\dfrac{\delta\theta}{\delta x}=k\ll 1.
   $$
   从而$T$与时间无关. 

2. 弧长$\displaystyle{\delta s=\int_{x}^{x+\delta x}\sqrt{1+(\partial_x u(t,\xi))^2}\mathrm d\xi}$. 其中
   $$
   \partial _xu\sim \tan\alpha\sim \alpha\ll 1.
   $$
   为小量, 因此$\delta s=\delta x+o(\delta x)$. 据Hooke定理知$T$与$x$亦无关. 

3. $x$在$y$向受力平衡, 即
   $$
   T(t,x+\delta x)\sin\beta-T(t,x)\sin\alpha+\int_{x}^{x+\delta x}f(t,\xi)\mathrm d\xi=\rho\delta x\partial_{tt}(t,\overline x).
   $$
   其中$f$为某一描述单位长度受外力作用的函数(如重力函数), $\rho$为绳索密度. 上述公式左端为合外力, 右端为加速度, 其中$\overline x$为$x$至$x+\delta x$间的某一等效值. 

由上述, 不妨记拉力为$T_0$. 注意到
$$
\sin\alpha\sim \tan\alpha\sim \partial_nx.
$$
因此
$$
T_0(\partial u_x(t,x+\delta x)-\partial u_x(t,x))+\int_{x}^{x+\delta}f(t,\xi)\mathrm d\xi=\rho\delta x\partial _{tt}u(t,\overline x).
$$
由中值定理得
$$
\partial_{tt}u-a^2\partial_{xx}u=f.
$$
同理有初值条件. 同样, 若边界函数值被直接给出, 则为Dirichlet条件; 若张力于边界处分量, 即$\partial _n u\cdot T$给定, 则为第二类边界条件. 边界满足Hooke定理时则对$\forall x_0\in\partial \Omega$均有
$$
-T\partial_x u\mid_{x=x_o}=ku\mid_{x=x_0}.
$$
即$(\partial_t u+\sigma u)\mid_{t\times \partial\Omega}=\varphi(t,x)$, Robin条件也. 

### 高维波动方程

结合先前所求解的空气动力学方程
$$
\left\{\begin{align*}
&\partial_t(\rho \vec u)+\mathrm{div}(\rho\vec u\otimes\vec u)+\nabla p=0\\
&\rho_t+\mathrm {div}(\rho \vec u)=0
\end{align*}\right..
$$
考虑小扰动后的结果$(\rho_0(1+s),\vec u)$, 代入质量守恒式(方程组下式)得
$$
\partial _t(s)+(1+s)\mathrm{div}(u)+(u\cdot\nabla )(1+s)=0.
$$
删去小量$s\mathrm{div}(u)$与$(u\cdot\nabla)s$得$\partial_ts+\mathrm{div }(u)=0$. 

于各方向上考虑方程
$$
\partial_t(\rho u_j)+\sum_{k=1}^3\partial_{x_k}(\rho u_ju_k)+\partial_{x_j}p=0.
$$
从而
$$
\partial_t(u_j)+\sum_{k=1}^3\partial_{x_k}(u_k\partial_{x_k}u_j)+\dfrac{1}{\rho}\partial_{x_j}p=0.
$$
其中$\dfrac{\partial_{x_j}p(\rho)}{\rho}=\dfrac{p'(\rho)}{\rho}\dfrac{\partial\rho}{\partial x_j}=\left(\dfrac{p'(\rho_0)}{\rho_0}+o(1)\right)\partial_{x_j}\rho$. 

整合$j$, 得$\partial_tu+p'(\rho_0)\nabla s=0$. 从而
$$
\left\{\begin{align*}
&\partial_tu+p'(\rho_0)\nabla s=0\\
&\partial_ts+\mathrm{div}(u)=0
\end{align*}\right..
$$
对下式关于$t$​求导得$\partial_{tt}s+\mathrm{div}(\partial _tu)=0$​, 回代上式得
$$
\partial_{tt}s=\mathrm{div}(p'(\rho_0)\nabla s)=p'(\rho_0)\Delta s.
$$
故得波动方程. 
$$
\dfrac{\partial^2}{\partial t^2}s-c^2\Delta s=0.
$$
其中$c=\sqrt{p'(\rho_0)}$为声速. 定解条件边值条件等同理一维情形, 不再赘述. 
